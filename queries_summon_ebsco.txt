#
#
# ~~ is the equal sign! (because there are equal signs in the queries we can't delimit by that)
#	
# FULL queries need to have an additional variable $recordSearch. This is so that the code can do
# count(*) ahead of time so it knows when to stop searching.
# The software will append RECORD_ID > X AND RECORD_ID < Y - Repeat for the population for the DB
summon_wjc_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					(LOCATION_CODE BETWEEN 'wjb' AND 'wjt')
					OR
					(LOCATION_CODE BETWEEN 'wjx' AND 'wjy')
				)
			)
			AND
			(BCODE3='z' OR BCODE3='-')
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_wjc_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'wj%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='wju'
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_wjc_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					(LOCATION_CODE BETWEEN 'wjb' AND 'wjt')
					OR
					(LOCATION_CODE BETWEEN 'wjx' AND 'wjy')
				)
			)
			AND
			(BCODE3='z' OR BCODE3='-');
summon_trcc_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(RECORD_ID IN(SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE LOCATION_CODE BETWEEN 'tr' AND 'trzzz'))
			AND			
			(BCODE3='z' OR BCODE3='-' OR BCODE3='l')
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_trcc_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 't%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='tub'
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_trcc_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(RECORD_ID IN(SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE LOCATION_CODE BETWEEN 'tr' AND 'trzzz'))
			AND			
			(BCODE3='z' OR BCODE3='-' OR BCODE3='l');
summon_ucm_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3!='c' AND BCODE3!='d' AND BCODE3!='l' AND BCODE3!='m' AND BCODE3!='n' AND BCODE3!='s' AND BCODE3!='t' )
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'ckb' AND 'ckv'
					OR					
					LOCATION_CODE = 'cky'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_ucm_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'ck%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='ckw'
				)
			)
			AND			
			(BCODE3!='-' AND BCODE3!='a' AND BCODE3!='z' )
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_ucm_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3!='c' AND BCODE3!='d' AND BCODE3!='l' AND BCODE3!='m' AND BCODE3!='n' AND BCODE3!='s' AND BCODE3!='t' )
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'ckb' AND 'ckv'
					OR					
					LOCATION_CODE = 'cky'
				);
summon_mssu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 					
					LOCATION_CODE = 'msb'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_mssu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3='n' OR BCODE3='s' OR BCODE3='d')
			AND			
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'ms%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='msu'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_mssu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 					
					LOCATION_CODE = 'msb'
				);
ebsco_wwu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3='-')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE = 'wdb'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_wwu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'wd%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='wdw'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_wwu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3='-')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE = 'wdb'
				);
ebsco_midwestern_babtist_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3='-' OR BCODE3='a' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'b' AND 'bzzzz'
				)
			AND			
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_midwestern_babtist_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'bt%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE ='btu'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_midwestern_babtist_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 				
			(BCODE3='-' OR BCODE3='a' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'b' AND 'bzzzz'
				);
ebsco_maryville_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3!='n' AND BCODE3!='s')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'mu1' AND 'mu9' OR
					LOCATION_CODE = 'mub'					
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_maryville_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
			(
				SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					(
						SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
						LOCATION_CODE LIKE 'm%' AND LENGTH(TRIM(LOCATION_CODE))=3
						GROUP BY BIB_RECORD_ID
					) AS C WHERE COUNT='1'
				)  AND LOCATION_CODE ='mzb'
			) 
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_maryville_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3!='n' AND BCODE3!='s')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'mu1' AND 'mu9' OR
					LOCATION_CODE = 'mub'
				);
ebsco_sbu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'b' AND 'bzzzz' AND
					LOCATION_CODE != 'bbu'
				)
			)
			AND
			(BCODE3='z' OR BCODE3='-' OR BCODE3='l' OR BCODE3='a')
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_sbu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
			(
				SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					(
						SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
						LOCATION_CODE LIKE 'b%' AND LENGTH(TRIM(LOCATION_CODE))=3
						GROUP BY BIB_RECORD_ID
					) AS C WHERE COUNT='1'
				)  AND LOCATION_CODE ='bbu'
			) 
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_sbu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'b' AND 'bzzzz' AND
					LOCATION_CODE != 'bbu'
				)
			)
			AND
			(BCODE3='z' OR BCODE3='-' OR BCODE3='l' OR BCODE3='a');
ebsco_mwsu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3!='n' AND BCODE3!='s')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'm2' AND 'm2zzz' AND
					LOCATION_CODE != 'm2d' AND
					LOCATION_CODE != 'm2u'				
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_mwsu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
			(
				SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					(
						SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
						LOCATION_CODE LIKE 'm2%' AND LENGTH(TRIM(LOCATION_CODE))=3
						GROUP BY BIB_RECORD_ID
					) AS C WHERE COUNT='1'
				)  AND LOCATION_CODE = 'm2u'
			) 
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_mwsu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3!='n' AND BCODE3!='s')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE BETWEEN 'm2' AND 'm2zzz' AND
					LOCATION_CODE != 'm2d' AND
					LOCATION_CODE != 'm2u'
				);
summon_tsu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE = 'tpb'
				)
			)
			AND
			BCODE3='-'
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_tsu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 't%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND LOCATION_CODE = 'tub'
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
summon_tsu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE = 'tpb'
				)
			)
			AND
			BCODE3='-';
ebsco_lu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'l%' AND
					LOCATION_CODE != 'lpu' AND
					LOCATION_CODE != 'lpw'				
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_lu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'l%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND (LOCATION_CODE = 'lpu' OR LOCATION_CODE = 'lpw')
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_lu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'l%' AND
					LOCATION_CODE != 'lpu' AND
					LOCATION_CODE != 'lpw'				
				);
ebsco_fontbonne_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'f%' AND 
					LOCATION_CODE != 'fub'					
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_fontbonne_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 							
			RECORD_ID IN
			(
				SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					(
						SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
						LOCATION_CODE LIKE 'f%' AND LENGTH(TRIM(LOCATION_CODE))=3
						GROUP BY BIB_RECORD_ID
					) AS C WHERE COUNT='1'
				)  AND LOCATION_CODE ='fub'
			) 
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_fontbonne_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'f%' AND 
					LOCATION_CODE != 'fub'
				);
ebsco_cc_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'c%' AND
					LOCATION_CODE != 'csu' AND
					LOCATION_CODE != 'csw'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_cc_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'c%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND (LOCATION_CODE = 'csw' OR LOCATION_CODE = 'csu')
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_cc_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'c%' AND
					LOCATION_CODE != 'csu' AND
					LOCATION_CODE != 'csw'		
				);
ebsco_westminster_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					(LOCATION_CODE LIKE '2c%' OR
					LOCATION_CODE LIKE '2j%' OR
					LOCATION_CODE LIKE '2m%' OR
					LOCATION_CODE LIKE '2r%' OR
					LOCATION_CODE LIKE '2t%' OR
					LOCATION_CODE LIKE '2w%' )AND
					LOCATION_CODE != '2ru'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_westminster_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE '2%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND (LOCATION_CODE = '2ru')
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_westminster_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					(LOCATION_CODE LIKE '2c%' OR
					LOCATION_CODE LIKE '2j%' OR
					LOCATION_CODE LIKE '2m%' OR
					LOCATION_CODE LIKE '2r%' OR
					LOCATION_CODE LIKE '2t%' OR
					LOCATION_CODE LIKE '2w%' )AND
					LOCATION_CODE != '2ru'
				);
ebsco_atsu_adds~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'k%' AND
					LOCATION_CODE != 'kub'
				)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_atsu_cancels~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(
				RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE BIB_RECORD_ID IN
					(
						SELECT BIB_RECORD_ID FROM 
						(
							SELECT COUNT(*) AS COUNT ,BIB_RECORD_ID FROM SIERRA_VIEW.BIB_RECORD_LOCATION WHERE
							LOCATION_CODE LIKE 'k%' AND LENGTH(TRIM(LOCATION_CODE))=3
							GROUP BY BIB_RECORD_ID
						) AS C WHERE COUNT='1'
					)  AND (LOCATION_CODE = 'kub')
				)
			)
			AND
			(RECORD_ID IN (SELECT ID FROM SIERRA_VIEW.RECORD_METADATA WHERE 
			(RECORD_LAST_UPDATED_GMT > TO_DATE('$dbFromDate','YYYY-MM-DD HH24:MI:MS')) AND 
			(RECORD_LAST_UPDATED_GMT < TO_DATE('$dbToDate','YYYY-MM-DD HH24:MI:MS'))));
ebsco_atsu_full~~SELECT $recordSearch FROM SIERRA_VIEW.BIB_RECORD WHERE 
			(BCODE3='a' OR BCODE3='-' OR BCODE3='z' OR BCODE3='l')
			AND
			RECORD_ID IN
				(
					SELECT BIB_RECORD_ID FROM 
					SIERRA_VIEW.BIB_RECORD_LOCATION WHERE 
					LOCATION_CODE LIKE 'k%' AND
					LOCATION_CODE != 'kub'
				);